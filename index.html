<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Love Language Path – Quiz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Discover your primary love language with a 10-question quiz and see who you pair best with." />
  <style>
    :root {
      --bg: #050816;
      --card: #111827;
      --card-soft: #020617;
      --accent: #fb7185;
      --accent-soft: rgba(251, 113, 133, 0.2);
      --accent-gold: #facc15;
      --text-main: #f9fafb;
      --text-soft: #9ca3af;
      --border-soft: #1f2937;
      --error: #fca5a5;
      --radius-lg: 18px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      min-height: 100vh;
      background:
        radial-gradient(circle at top, #1f2937 0, #020617 55%, #000 100%);
      color: var(--text-main);
      display: flex;
      justify-content: center;
      padding: 16px;
    }

    .app-shell {
      width: 100%;
      max-width: 480px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    header {
      text-align: center;
      padding-top: 4px;
    }

    header h1 {
      font-size: 1.5rem;
      letter-spacing: 0.04em;
    }

    header p {
      margin-top: 6px;
      font-size: 0.9rem;
      color: var(--text-soft);
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: rgba(15, 23, 42, 0.9);
      border-radius: 999px;
      padding: 4px 10px;
      margin-bottom: 6px;
      font-size: 0.75rem;
      color: var(--accent-soft);
      border: 1px solid rgba(251, 113, 133, 0.4);
    }

    .pill-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 10px rgba(251, 113, 133, 0.8);
    }

    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .card {
      background:
        radial-gradient(circle at top left, rgba(251, 113, 133, 0.22), transparent 55%),
        radial-gradient(circle at bottom right, rgba(56, 189, 248, 0.18), transparent 60%),
        var(--card);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-soft);
      padding: 18px 16px 14px;
      box-shadow: 0 18px 45px rgba(0, 0, 0, 0.7);
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.4), transparent 60%);
      pointer-events: none;
    }

    .card-inner {
      position: relative;
      z-index: 1;
    }

    .card-title {
      font-size: 1.25rem;
      margin-bottom: 6px;
    }

    .card-subtitle {
      font-size: 0.9rem;
      color: var(--text-soft);
      margin-bottom: 10px;
    }

    .intro-grid {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 4px;
    }

    .intro-row {
      font-size: 0.85rem;
      color: var(--text-soft);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .intro-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent-soft);
    }

    .tagline {
      margin-top: 6px;
      font-size: 0.86rem;
      color: var(--text-main);
    }

    .btn-row {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 12px;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 9px 14px;
      font-size: 0.9rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      white-space: nowrap;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--accent), var(--accent-gold));
      color: #111827;
      font-weight: 600;
      box-shadow: 0 0 18px rgba(251, 113, 133, 0.65);
    }

    .btn-primary:active {
      transform: translateY(1px);
      box-shadow: 0 0 10px rgba(251, 113, 133, 0.5);
    }

    .btn-secondary {
      background: rgba(15, 23, 42, 0.96);
      color: var(--text-soft);
      border: 1px solid rgba(148, 163, 184, 0.6);
    }

    .btn-secondary:disabled {
      opacity: 0.4;
      cursor: default;
    }

    .btn-ghost {
      background: transparent;
      color: var(--text-soft);
      border: 1px dashed rgba(148, 163, 184, 0.4);
    }

    .helper-small {
      font-size: 0.77rem;
      color: var(--text-soft);
      margin-top: 4px;
    }

    /* Progress + Quiz */
    .progress-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 10px;
    }

    .progress-label {
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-soft);
    }

    .progress-bar {
      flex: 1;
      height: 6px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.85);
      overflow: hidden;
      border: 1px solid rgba(148, 163, 184, 0.4);
    }

    .progress-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--accent), var(--accent-gold));
      transition: width 0.25s ease-out;
    }

    .question-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.8rem;
      margin-bottom: 10px;
      color: var(--text-soft);
    }

    .question-tag {
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.5);
      text-transform: uppercase;
      font-size: 0.72rem;
      letter-spacing: 0.06em;
    }

    .question-text {
      font-size: 1.05rem;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .helper-text {
      font-size: 0.8rem;
      color: var(--text-soft);
      margin-bottom: 6px;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 8px;
    }

    .option {
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(31, 41, 55, 0.95);
      padding: 9px 11px;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: border 0.16s ease, background 0.16s ease, transform 0.08s ease;
    }

    .option:hover {
      border-color: rgba(251, 113, 133, 0.7);
      background: rgba(15, 23, 42, 0.98);
      transform: translateY(-1px);
    }

    .option input {
      accent-color: var(--accent);
      width: 16px;
      height: 16px;
    }

    .option-label-text {
      flex: 1;
    }

    .error-text {
      font-size: 0.78rem;
      color: var(--error);
      margin-bottom: 4px;
      min-height: 16px;
    }

    .nav-row {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      margin-top: 6px;
    }

    /* Results */
    .hidden {
      display: none;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 5px 9px;
      font-size: 0.78rem;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.92);
      border: 1px solid rgba(148, 163, 184, 0.4);
      margin-bottom: 6px;
    }

    .badge-pill {
      width: 9px;
      height: 9px;
      border-radius: 999px;
      background: var(--accent);
    }

    .result-title {
      font-size: 1.2rem;
      margin-bottom: 4px;
    }

    .result-subtitle {
      font-size: 0.86rem;
      color: var(--text-soft);
      margin-bottom: 10px;
    }

    .result-section {
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px dashed rgba(148, 163, 184, 0.45);
    }

    .result-section h3 {
      font-size: 0.95rem;
      margin-bottom: 4px;
    }

    .result-section p {
      font-size: 0.86rem;
      color: var(--text-main);
    }

    .love-type-list {
      list-style: none;
      margin-top: 6px;
      font-size: 0.84rem;
    }

    .love-type-list li {
      display: flex;
      justify-content: space-between;
      padding: 4px 0;
      border-bottom: 1px dashed rgba(30, 64, 175, 0.3);
    }

    .love-type-name {
      color: var(--text-soft);
    }

    .love-type-score {
      color: var(--accent);
      font-weight: 600;
    }

    .share-row {
      margin-top: 10px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .share-status {
      font-size: 0.78rem;
      color: var(--text-soft);
      min-height: 16px;
    }

    footer {
      text-align: center;
      font-size: 0.75rem;
      color: var(--text-soft);
      margin-bottom: 4px;
      margin-top: 4px;
    }

    footer span {
      color: var(--accent-soft);
    }

    @media (min-width: 480px) {
      header h1 {
        font-size: 1.7rem;
      }
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <header>
      <div class="pill">
        <span class="pill-dot"></span>
        Love Language Path · 10 Questions
      </div>
      <h1>How Do You Give & Receive Love?</h1>
      <p>Not a diagnosis, just a mirror. Answer honestly and treat this as a gentle check-in, not a box to live inside.</p>
    </header>

    <main>
      <!-- INTRO CARD -->
      <section id="intro-card" class="card">
        <div class="card-inner">
          <h2 class="card-title">Start Your Love Language Path</h2>
          <p class="card-subtitle">
            This short test blends personality-style questions with the 5 classic love languages
            to show what you gravitate toward in real life, not just what sounds nice on paper.
          </p>

          <div class="intro-grid">
            <div class="intro-row">
              <span class="intro-dot"></span>
              <span>10 questions · 3–5 minutes · no email required.</span>
            </div>
            <div class="intro-row">
              <span class="intro-dot"></span>
              <span>You’ll get a primary and secondary love language.</span>
            </div>
            <div class="intro-row">
              <span class="intro-dot"></span>
              <span>We’ll also show which partner styles tend to pair well with you.</span>
            </div>
          </div>

          <p class="tagline">
            Take a breath. Answer like no one’s watching. This works best when you answer for how you
            actually behave & feel, not how you think you “should” be.
          </p>

          <div class="btn-row">
            <button id="start-btn" type="button" class="btn-primary">
              Start the quiz →
            </button>
            <button id="about-toggle-btn" type="button" class="btn-ghost">
              What are the 5 love languages?
            </button>
            <p id="about-body" class="helper-small hidden">
              The 5 love languages describe how people most naturally give and receive love:
              <strong>Words of Affirmation</strong> (spoken appreciation),
              <strong>Quality Time</strong> (focused presence),
              <strong>Acts of Service</strong> (help and support),
              <strong>Receiving Gifts</strong> (thoughtful tangible reminders),
              and <strong>Physical Touch</strong> (closeness and affection).
              Most people have a primary style and a strong secondary one.
            </p>
          </div>
        </div>
      </section>

      <!-- QUIZ CARD -->
      <section id="quiz-card" class="card hidden">
        <div class="card-inner">
          <div class="progress-row">
            <div class="progress-label" id="question-count-label">Question 1 / 10</div>
            <div class="progress-bar">
              <div id="progress-fill" class="progress-fill"></div>
            </div>
          </div>

          <div class="question-meta">
            <span id="question-kind" class="question-tag">Single choice</span>
            <span id="question-index-label">Step 1 of 10</span>
          </div>

          <h2 id="question-text" class="question-text">Loading...</h2>
          <p id="helper-text" class="helper-text"></p>

          <form id="options-container" class="options"></form>

          <div id="error-text" class="error-text"></div>

          <div class="nav-row">
            <button id="back-btn" type="button" class="btn-secondary">← Back</button>
            <button id="next-btn" type="button" class="btn-primary">Next →</button>
          </div>
          <p class="helper-small">
            Tip: Go with your first honest instinct, not the answer you think looks best.
          </p>
        </div>
      </section>

      <!-- RESULT CARD -->
      <section id="result-card" class="card hidden">
        <div class="card-inner">
          <div class="badge">
            <span class="badge-pill"></span>
            Your Love Language Snapshot
          </div>
          <h2 id="result-title" class="result-title">Your Love Language</h2>
          <p id="result-subtitle" class="result-subtitle"></p>

          <div class="result-section">
            <h3>Primary & Secondary Love Languages</h3>
            <p id="primary-description"></p>
          </div>

          <div class="result-section">
            <h3>Best Partner Matches For You</h3>
            <p id="match-description"></p>
          </div>

          <div class="result-section">
            <h3>How You Scored</h3>
            <ul id="score-list" class="love-type-list"></ul>
          </div>

          <div class="share-row">
            <button id="share-btn" type="button" class="btn-primary">
              Share my result
            </button>
            <p id="share-status" class="share-status"></p>
          </div>

          <div class="btn-row" style="margin-top:12px;">
            <button id="restart-btn" type="button" class="btn-secondary">Retake quiz</button>
            <button id="back-to-intro-btn" type="button" class="btn-ghost">Back to intro</button>
          </div>
        </div>
      </section>
    </main>

    <footer>
      Built with care, not just code. <span>Use this as a conversation starter, not a verdict.</span>
    </footer>
  </div>

  <script>
    // Love language keys
    const LOVE_KEYS = ["words", "time", "service", "gifts", "touch"];

    const LOVE_META = {
      words: {
        name: "Words of Affirmation",
        summary: "You feel loved when someone speaks to your heart — with honesty, encouragement, and appreciation.",
        matches: ["Quality Time", "Acts of Service"],
        long:
          "You pay attention to tone, wording, and small verbal details. You thrive when your partner notices you and says it out loud: specific compliments, gratitude for what you do, and encouragement when you feel low."
      },
      time: {
        name: "Quality Time",
        summary: "You feel loved when someone gives you their focus — phones down, mind present, energy actually with you.",
        matches: ["Words of Affirmation", "Physical Touch"],
        long:
          "You care less about grand gestures and more about the feeling that someone made space for you. Shared routines, deep talks, or even quiet time together recharge you more than anything else."
      },
      service: {
        name: "Acts of Service",
        summary: "You feel loved when people take things off your plate — helping with tasks, errands, or stress points.",
        matches: ["Quality Time", "Receiving Gifts"],
        long:
          "Support means action. When someone notices what would make your life easier and simply does it, you feel seen and valued. Small, consistent actions matter more than dramatic promises."
      },
      gifts: {
        name: "Receiving Gifts",
        summary: "You feel loved when someone gives you physical reminders that they were thinking about you.",
        matches: ["Words of Affirmation", "Acts of Service"],
        long:
          "It’s not about the price. It’s about the story and intention behind the gift. A note, a snack, a flower, or something handmade can mean the world if it carries memory, care, or inside meaning."
      },
      touch: {
        name: "Physical Touch",
        summary: "You feel loved through physical closeness — hugs, hand-holding, cuddles, and gentle contact.",
        matches: ["Quality Time", "Words of Affirmation"],
        long:
          "You experience safety and connection through physical presence. A quick hug before leaving, sitting close on the couch, or a hand on your shoulder can say more than a paragraph of words."
      }
    };

    // Questions
    const QUESTIONS = [
      {
        id: 1,
        kind: "yesno",
        text: "When you’re having a rough day, do encouraging words help you feel noticeably better?",
        helper: "Yes / No question",
        options: [
          {
            value: "yes",
            label: "Yes, the right words can totally shift my mood.",
            scores: { words: 2, time: 1 }
          },
          {
            value: "no",
            label: "Not really, I need something else to feel better.",
            scores: { service: 1, touch: 1 }
          }
        ]
      },
      {
        id: 2,
        kind: "single",
        text: "Your partner surprises you after a long week. What makes you feel most cared for?",
        helper: "Choose the one that feels the most nourishing, not the most logical.",
        options: [
          {
            value: "a",
            label: "They plan an evening just for the two of you — no distractions.",
            scores: { time: 2, touch: 1 }
          },
          {
            value: "b",
            label: "They leave a heartfelt note or voice message about how much you mean to them.",
            scores: { words: 2 }
          },
          {
            value: "c",
            label: "They quietly handle chores and tasks so you can rest.",
            scores: { service: 2 }
          },
          {
            value: "d",
            label: "They give you a small, thoughtful gift that feels very “you.”",
            scores: { gifts: 2 }
          }
        ]
      },
      {
        id: 3,
        kind: "multi",
        text: "Pick up to two things that make you instantly feel closer to someone.",
        helper: "You can select 1 or 2 options.",
        options: [
          {
            value: "a",
            label: "Deep, honest conversation.",
            scores: { words: 1, time: 1 }
          },
          {
            value: "b",
            label: "Sitting side by side, doing something together.",
            scores: { time: 2 }
          },
          {
            value: "c",
            label: "They fix or handle something that’s been stressing you.",
            scores: { service: 2 }
          },
          {
            value: "d",
            label: "Hugs, cuddles, or playful physical closeness.",
            scores: { touch: 2 }
          },
          {
            value: "e",
            label: "They bring you a snack, drink, or little treat they know you like.",
            scores: { gifts: 2 }
          }
        ]
      },
      {
        id: 4,
        kind: "yesno",
        text: "Do you start to doubt people’s feelings for you if they rarely say them out loud?",
        helper: "Yes / No question",
        options: [
          {
            value: "yes",
            label: "Yes, if they don’t say it, I start to question it.",
            scores: { words: 2 }
          },
          {
            value: "no",
            label: "No, I can feel loved even without hearing it often.",
            scores: { time: 1, service: 1, touch: 1 }
          }
        ]
      },
      {
        id: 5,
        kind: "single",
        text: "Which of these stings the most in a relationship?",
        helper: "Pick the one that hits your gut, not just your mind.",
        options: [
          {
            value: "a",
            label: "Thoughtless or harsh comments.",
            scores: { words: 2 }
          },
          {
            value: "b",
            label: "They’re always busy and rarely present with you.",
            scores: { time: 2 }
          },
          {
            value: "c",
            label: "They don’t offer help even when they see you’re overwhelmed.",
            scores: { service: 2 }
          },
          {
            value: "d",
            label: "They rarely initiate hugs, hand-holding, or physical closeness.",
            scores: { touch: 2 }
          },
          {
            value: "e",
            label: "They forget meaningful dates or never bring small surprises.",
            scores: { gifts: 2 }
          }
        ]
      },
      {
        id: 6,
        kind: "multi",
        text: "Imagine your ideal slow day with someone you care about. What’s happening?",
        helper: "Choose 1–3 things that feel most like love to you.",
        options: [
          {
            value: "a",
            label: "We talk about life, dreams, and deep topics.",
            scores: { words: 1, time: 1 }
          },
          {
            value: "b",
            label: "We do chores, errands, or projects together and actually get things done.",
            scores: { service: 2 }
          },
          {
            value: "c",
            label: "We watch something or go out, but the focus is just being together.",
            scores: { time: 2 }
          },
          {
            value: "d",
            label: "There are cuddles, hugs, or just leaning on each other.",
            scores: { touch: 2 }
          },
          {
            value: "e",
            label: "They surprise me with a little item or snack they know I wanted.",
            scores: { gifts: 2 }
          }
        ]
      },
      {
        id: 7,
        kind: "single",
        text: "When you think back on your favorite memories with someone, what stands out most?",
        helper: "Choose the type of moment that you replay the most.",
        options: [
          {
            value: "a",
            label: "Specific things they said that made you feel seen.",
            scores: { words: 2 }
          },
          {
            value: "b",
            label: "A time you spent hours together and lost track of time.",
            scores: { time: 2 }
          },
          {
            value: "c",
            label: "A moment they stepped in and handled something big for you.",
            scores: { service: 2 }
          },
          {
            value: "d",
            label: "A meaningful gift or physical keepsake you still have.",
            scores: { gifts: 2 }
          },
          {
            value: "e",
            label: "A hug, kiss, or physical moment you can still feel.",
            scores: { touch: 2 }
          }
        ]
      },
      {
        id: 8,
        kind: "yesno",
        text: "Do you feel especially close to someone when you’re physically near them (even in silence)?",
        helper: "Yes / No question",
        options: [
          {
            value: "yes",
            label: "Yes, just being near them is enough sometimes.",
            scores: { time: 1, touch: 2 }
          },
          {
            value: "no",
            label: "Not really, I need more than just being in the same space.",
            scores: { words: 1, service: 1 }
          }
        ]
      },
      {
        id: 9,
        kind: "single",
        text: "You haven’t seen your partner in a while. What would make you feel most loved when you reconnect?",
        helper: "Pick the one that would genuinely hit the hardest (in a good way).",
        options: [
          {
            value: "a",
            label: "They tell you how much they missed you and what they appreciate about you.",
            scores: { words: 2 }
          },
          {
            value: "b",
            label: "They clear their schedule to give you unhurried time.",
            scores: { time: 2 }
          },
          {
            value: "c",
            label: "They show up and immediately start helping with whatever’s on your plate.",
            scores: { service: 2 }
          },
          {
            value: "d",
            label: "They bring a small, meaningful gift from where they’ve been.",
            scores: { gifts: 2 }
          },
          {
            value: "e",
            label: "They pull you into a long hug and stay close.",
            scores: { touch: 2 }
          }
        ]
      },
      {
        id: 10,
        kind: "multi",
        text: "In a long-term relationship, what do you absolutely need on a regular basis?",
        helper: "Choose 1–3 non-negotiables.",
        options: [
          {
            value: "a",
            label: "Kind, honest words and check-ins.",
            scores: { words: 2 }
          },
          {
            value: "b",
            label: "Regular, dedicated time together with minimal distractions.",
            scores: { time: 2 }
          },
          {
            value: "c",
            label: "Practical support with life, chores, or responsibilities.",
            scores: { service: 2 }
          },
          {
            value: "d",
            label: "Thoughtful gifts, treats, or physical reminders of the relationship.",
            scores: { gifts: 2 }
          },
          {
            value: "e",
            label: "Consistent physical affection and closeness.",
            scores: { touch: 2 }
          }
        ]
      }
    ];

    // STATE
    let currentIndex = 0; // 0–9 for 10 questions
    const answersState = {}; // { [questionId]: string | string[] }

    // DOM
    const introCard = document.getElementById("intro-card");
    const quizCard = document.getElementById("quiz-card");
    const resultCard = document.getElementById("result-card");

    const startBtn = document.getElementById("start-btn");
    const aboutToggleBtn = document.getElementById("about-toggle-btn");
    const aboutBody = document.getElementById("about-body");

    const questionTextEl = document.getElementById("question-text");
    const helperTextEl = document.getElementById("helper-text");
    const optionsContainer = document.getElementById("options-container");
    const errorTextEl = document.getElementById("error-text");
    const questionKindEl = document.getElementById("question-kind");
    const questionCountLabelEl = document.getElementById("question-count-label");
    const questionIndexLabelEl = document.getElementById("question-index-label");
    const progressFillEl = document.getElementById("progress-fill");

    const backBtn = document.getElementById("back-btn");
    const nextBtn = document.getElementById("next-btn");

    const resultTitleEl = document.getElementById("result-title");
    const resultSubtitleEl = document.getElementById("result-subtitle");
    const primaryDescriptionEl = document.getElementById("primary-description");
    const matchDescriptionEl = document.getElementById("match-description");
    const scoreListEl = document.getElementById("score-list");
    const shareBtn = document.getElementById("share-btn");
    const shareStatusEl = document.getElementById("share-status");
    const restartBtn = document.getElementById("restart-btn");
    const backToIntroBtn = document.getElementById("back-to-intro-btn");

    function getQuestionLabel(kind) {
      if (kind === "yesno") return "Yes / No";
      if (kind === "single") return "Single choice";
      if (kind === "multi") return "Multi-select";
      return "";
    }

    function renderQuestion() {
      const q = QUESTIONS[currentIndex];
      const total = QUESTIONS.length;
      const step = currentIndex + 1;

      errorTextEl.textContent = "";

      questionTextEl.textContent = q.text;
      helperTextEl.textContent = q.helper || "";
      questionKindEl.textContent = getQuestionLabel(q.kind);

      questionCountLabelEl.textContent = `Question ${step} / ${total}`;
      questionIndexLabelEl.textContent = `Step ${step} of ${total}`;

      const pct = (step / total) * 100;
      progressFillEl.style.width = pct + "%";

      optionsContainer.innerHTML = "";
      const stored = answersState[q.id];

      q.options.forEach((opt, idx) => {
        const optionId = `q${q.id}_opt${idx}`;
        const wrapper = document.createElement("label");
        wrapper.className = "option";

        const input = document.createElement("input");
        input.id = optionId;

        if (q.kind === "multi") {
          input.type = "checkbox";
          if (Array.isArray(stored) && stored.includes(opt.value)) {
            input.checked = true;
          }
        } else {
          input.type = "radio";
          input.name = `q${q.id}`;
          if (stored === opt.value) {
            input.checked = true;
          }
        }

        input.value = opt.value;

        const textWrap = document.createElement("div");
        textWrap.className = "option-label-text";
        const main = document.createElement("div");
        main.textContent = opt.label;

        textWrap.appendChild(main);
        wrapper.appendChild(input);
        wrapper.appendChild(textWrap);
        optionsContainer.appendChild(wrapper);
      });

      backBtn.disabled = currentIndex === 0;
      nextBtn.textContent = currentIndex === total - 1 ? "See my results →" : "Next →";
    }

    function collectAnswer() {
      const q = QUESTIONS[currentIndex];

      if (q.kind === "multi") {
        const checked = Array.from(
          optionsContainer.querySelectorAll("input[type='checkbox']:checked")
        ).map((el) => el.value);
        if (checked.length === 0) return null;
        return checked;
      } else {
        const checked = optionsContainer.querySelector("input[type='radio']:checked");
        if (!checked) return null;
        return checked.value;
      }
    }

    function handleNext() {
      const answer = collectAnswer();
      if (!answer || (Array.isArray(answer) && answer.length === 0)) {
        errorTextEl.textContent = "Please select at least one option to continue.";
        return;
      }
      errorTextEl.textContent = "";

      const qId = QUESTIONS[currentIndex].id;
      answersState[qId] = answer;

      if (currentIndex === QUESTIONS.length - 1) {
        showResults();
      } else {
        currentIndex++;
        renderQuestion();
        window.scrollTo({ top: 0, behavior: "smooth" });
      }
    }

    function handleBack() {
      if (currentIndex === 0) return;
      currentIndex--;
      renderQuestion();
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    function computeScores() {
      const scores = {
        words: 0,
        time: 0,
        service: 0,
        gifts: 0,
        touch: 0
      };

      QUESTIONS.forEach((q) => {
        const ans = answersState[q.id];
        if (!ans) return;

        const applyOptionScores = (value) => {
          const opt = q.options.find((o) => o.value === value);
          if (!opt || !opt.scores) return;
          Object.entries(opt.scores).forEach(([key, val]) => {
            if (scores[key] != null) scores[key] += val;
          });
        };

        if (Array.isArray(ans)) {
          ans.forEach((v) => applyOptionScores(v));
        } else {
          applyOptionScores(ans);
        }
      });

      return scores;
    }

    function getPrimaryAndSecondary(scores) {
      const entries = LOVE_KEYS.map((key) => ({
        key,
        score: scores[key]
      })).sort((a, b) => b.score - a.score);

      const primary = entries[0];
      const secondary = entries[1];
      return { primary, secondary, ordered: entries };
    }

    function showResults() {
      const scores = computeScores();
      const { primary, secondary, ordered } = getPrimaryAndSecondary(scores);
      const pMeta = LOVE_META[primary.key];
      const sMeta = secondary ? LOVE_META[secondary.key] : null;

      resultTitleEl.textContent = `You lead with: ${pMeta.name}`;
      resultSubtitleEl.textContent = pMeta.summary;

      if (sMeta) {
        primaryDescriptionEl.textContent =
          `Your primary love language is ${pMeta.name}, with ${sMeta.name} coming in as a strong secondary. ` +
          `${pMeta.long} ` +
          `Your secondary, ${sMeta.name}, adds another layer to how you experience love day to day.`;
      } else {
        primaryDescriptionEl.textContent = pMeta.long;
      }

      const matchNames = pMeta.matches.join(" or ");
      matchDescriptionEl.textContent =
        `You’re often deeply understood by people whose primary or secondary love language is ${matchNames}. ` +
        `These styles naturally overlap with your needs, and your way of giving love tends to feed theirs in return. ` +
        `This doesn’t mean other matches can’t work — just that these will usually feel easiest and most intuitive.`;

      scoreListEl.innerHTML = "";
      ordered.forEach((entry) => {
        const li = document.createElement("li");
        const nameSpan = document.createElement("span");
        nameSpan.className = "love-type-name";
        nameSpan.textContent = LOVE_META[entry.key].name;

        const scoreSpan = document.createElement("span");
        scoreSpan.className = "love-type-score";
        scoreSpan.textContent = entry.score;

        li.appendChild(nameSpan);
        li.appendChild(scoreSpan);
        scoreListEl.appendChild(li);
      });

      quizCard.classList.add("hidden");
      resultCard.classList.remove("hidden");
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    function getCurrentSummaryText() {
      const scores = computeScores();
      const { primary, secondary } = getPrimaryAndSecondary(scores);
      const pMeta = LOVE_META[primary.key];
      const sMeta = secondary ? LOVE_META[secondary.key] : null;

      let text = "My Love Language Path result:\n";
      text += `Primary: ${pMeta.name}\n`;
      if (sMeta) {
        text += `Secondary: ${sMeta.name}\n`;
      }
      text += `Summary: ${pMeta.summary}\n`;
      text += "This is from a 10-question Love Language Path quiz.";
      return text;
    }

    async function handleShare() {
      shareStatusEl.textContent = "";

      const text = getCurrentSummaryText();
      if (navigator.share) {
        try {
          await navigator.share({
            title: "My Love Language Path result",
            text
          });
          shareStatusEl.textContent = "Shared successfully (if you completed the share sheet).";
        } catch (err) {
          // User may have cancelled; we don’t treat this as an error.
          shareStatusEl.textContent = "Share cancelled or not completed.";
        }
      } else if (navigator.clipboard && navigator.clipboard.writeText) {
        try {
          await navigator.clipboard.writeText(text);
          shareStatusEl.textContent = "Copied summary to your clipboard. You can paste it into a message or note.";
        } catch (err) {
          shareStatusEl.textContent = "Couldn’t access clipboard. You can screenshot or copy the text manually.";
        }
      } else {
        shareStatusEl.textContent =
          "Sharing is limited on this device. You can screenshot your result or copy details manually.";
      }
    }

    function restartQuiz() {
      Object.keys(answersState).forEach((k) => delete answersState[k]);
      currentIndex = 0;
      quizCard.classList.remove("hidden");
      resultCard.classList.add("hidden");
      renderQuestion();
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    function backToIntro() {
      Object.keys(answersState).forEach((k) => delete answersState[k]);
      currentIndex = 0;
      introCard.classList.remove("hidden");
      quizCard.classList.add("hidden");
      resultCard.classList.add("hidden");
      renderQuestion();
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    function startQuiz() {
      introCard.classList.add("hidden");
      resultCard.classList.add("hidden");
      quizCard.classList.remove("hidden");
      renderQuestion();
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    function toggleAbout() {
      const isHidden = aboutBody.classList.contains("hidden");
      if (isHidden) {
        aboutBody.classList.remove("hidden");
        aboutToggleBtn.textContent = "Hide love language explanation";
      } else {
        aboutBody.classList.add("hidden");
        aboutToggleBtn.textContent = "What are the 5 love languages?";
      }
    }

    // Event listeners
    startBtn.addEventListener("click", startQuiz);
    aboutToggleBtn.addEventListener("click", toggleAbout);

    backBtn.addEventListener("click", handleBack);
    nextBtn.addEventListener("click", handleNext);
    shareBtn.addEventListener("click", handleShare);
    restartBtn.addEventListener("click", restartQuiz);
    backToIntroBtn.addEventListener("click", backToIntro);

    // Prepare initial question so everything is ready when user starts
    renderQuestion();
  </script>
</body>
</html>
